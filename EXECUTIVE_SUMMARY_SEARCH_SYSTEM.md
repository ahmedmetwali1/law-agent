# ุงูููุฎุต ุงูุชูููุฐู: ูุธุงู ุงูุจุญุซ ุงููุงูููู

**ุงูุชุงุฑูุฎ:** 2026-02-05  
**ุงูููุนูุฏ:** ูุธุงู Antigravity AI  
**ุงูุญุงูุฉ:** ูุธุงู ุฅูุชุงุฌู ูุน ุชุญุณููุงุช ูุณุชูุฑุฉ

---

## ๐ฏ ุงูููุงุท ุงูุฑุฆูุณูุฉ

### 1. ุงูุจููุฉ ุงูุนุงูุฉ
- **ุงููุธุงู:** Multi-Agent AI System ุจูุงุกู ุนูู LangGraph
- **ูุงุนุฏุฉ ุงูุจูุงูุงุช:** Supabase PostgreSQL ูุน pgvector extension
- **ุงูุจุญุซ:** ูุธุงู ูุฌูู (Vector + Keyword) ุจุซูุงุซ ูุฑุงุญู

### 2. ุงููุณุงุฑ ุงููุงูููู

```
User Query โ Judge โ Deep Research โ [Council] โ Answer
```

**ุงููููุงุก ุงูุฃุณุงุณููู:**
1. **Judge (ุงูููุฌูู):** ุชุตููู ุงูุงุณุชุนูุงู (ุจุณูุท/ูุนูุฏ/ุฅุฏุงุฑู)
2. **Deep Research (ุงูุจุงุญุซ):** ุงูุจุญุซ ูู ูุงุนุฏุฉ ุงููุนุฑูุฉ
3. **Council (ุงููุฌูุณ):** ุงุณุชุดุงุฑุฉ ูุชุนุฏุฏุฉ ุงูุฃุจุนุงุฏ (ูููุถุงูุง ุงููุนูุฏุฉ)

### 3. ูุงุนุฏุฉ ุงููุนุฑูุฉ

**ุงููููุฐุฌ ุงูุทุจูู:**

| ุงููุณุชูู | ุงูุฌุฏูู | ุงููุตู |
|---------|--------|-------|
| 1 | `legal_sources` | ุงููุตุงุฏุฑ ุงููุงููููุฉ ุงููุงููุฉ (ุงููุชุจ) |
| 2 | `document_chunks` | ุงูุดุฑุงุฆุญ (ุงูุตูุญุงุช) ูุน embeddings |
| 3 | `thought_templates` | ุงููุจุงุฏุฆ ุงููุงููููุฉ ุงูุนุงูุฉ |

**ุงูููููู ุงูุญุฑุฌ:**
- ุงุณุชุฎุฏุงู `sequence_number` ูุงุณุชุฑุฌุงุน ุงูุณูุงู (ุงูููุงุฏ ุงูุณุงุจูุฉ ูุงููุงุญูุฉ)
- ุงุณุชุฑุฌุงุน ุงูุณูุงู ุนุจุฑ `GetRelatedDocumentTool` (Siblings: ยฑ2 chunks)

### 4. ูุญุฑู ุงูุจุญุซ ุงููุฌูู (HybridSearchTool v3.0)

**ุงููุฑุงุญู ุงูุซูุงุซ:**

#### **Scout Phase (ุงููุดุงูุฉ) ๐**
- Vector Search ุงูุฃููู (Top 12)
- ุงุณุชุฎุฑุงุฌ ุงูููุงูุงุช (ุฃุฑูุงู ุงูููุงุฏุ ุงูููุงููู)
- ุชุญููู LLM ูุชูุณูุน ุงููููุงุช ุงูููุชุงุญูุฉ
- ุชุตููู ููุน ุงูุงุณุชุนูุงู (Enumeration, Definition, Procedure...)

#### **Sniper Phase (ุงูููุงุต) ๐ฏ**
- ุจุญุซ ูุฒุฏูุฌ: Vector (40) + Keyword (40)
- ุฏูุฌ ูุฅุฒุงูุฉ ุงูุชูุฑุงุฑ
- **ุชุณุฌูู ุงูุตูุฉ ุงููุชูุฏู:**
  ```
  Score = Similarityร30% + EntityMatchร20% + KeywordDensityร20% + TypeBonusร30%
  ```
- ููุชุฑ ุงูุชููุน

#### **Expansion Phase (ุงูุชูุณูุน)**
- ุงุณุชุฑุฌุงุน ุงูุณูุงู (Siblings)
- ุฅุถุงูุฉ ุงููุจุงุฏุฆ ุงููุงููููุฉ ุฐุงุช ุงูุตูุฉ

### 5. ุฃููุงุท ุงูุงุณุชุนูุงู ุงููุฏุนููุฉ

| ุงูููุท | ูุซุงู | ุงุณุชุฑุงุชูุฌูุฉ ุงูุฅุฌุงุจุฉ |
|-------|------|---------------------|
| **LEGAL_SIMPLE** | "ูุง ุงููุงุฏุฉ 77ุ" | ุฅุฌุงุจุฉ ูุจุงุดุฑุฉ (Circuit Breaker) |
| **LEGAL_COMPLEX** | "ูู ูุญู ูููุงุตุฑ...ุ" | Council โ Judge โ Answer |
| **ARTICLE_ENUMERATION** | "ูุง ุงูููุงุฏ ุงูุฎุงุตุฉ ุจุงููุจุฉุ" | ุจุญุซ ุนู ุงูููุงุฑุณ + ุชูุณูุน |
| **DEFINITION** | "ูุง ุชุนุฑูู ุงููุจุฉุ" | ุงูุชุฑููุฒ ุนูู ุงููุตูุต ุงูุชุนุฑูููุฉ |

### 6. ุงูุชุญุฏูุงุช ุงูููุญููุฉ

#### โ **ูุดููุฉ ุงูุญููุงุช ุงููุงููุงุฆูุฉ**
- **ุงูุฃุนุฑุงุถ:** ุฅุนุงุฏุฉ ุทุฑุญ ููุณ ุงูุณุคุงู
- **ุงูุญู:** ุชุฌุงูุฒ Investigator ููุงุณุชุนูุงูุงุช ุงูุจุณูุทุฉ
- **ุงูููู:** `deep_research.py:47-129`

#### โ **ูุดููุฉ ููุฏุงู ุงูุณูุงู**
- **ุงูุฃุนุฑุงุถ:** ุนุฏู ุฅูุฌุงุฏ ุงูุงุณุชุซูุงุกุงุช ูู ุงูููุงุฏ ุงููุงุญูุฉ
- **ุงูุญู:** ุงุณุชุฑุฌุงุน Siblings (ยฑ2 chunks)
- **ุงูููู:** `deep_research.py:343-354`

#### โ๏ธ **ูุดููุฉ ููุฏ ุงููุนุงูุฌุฉ: ุนุฏู ุฅูุฌุงุฏ ูุชุงุฆุฌ**
- **ุงูุฃุนุฑุงุถ:** ุงูุจุญุซ ุนู "ุงููุจุฉ" ูุนูุฏ ุจู 0 ูุชุงุฆุฌ ุฑุบู ูุฌูุฏ ุงูุจูุงูุงุช
- **ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
  1. Row Level Security (RLS) blocks
  2. ุชุทุจูุน ุงููุต ุงูุนุฑุจู (ุฉ vs ู)
  3. ุบูุงุจ Embeddings
- **ุงูุญููู ุงููุทุจูุฉ:**
  - ุชุทุจูุน ุงููุต: `ARABIC_NORMALIZE` ูู `hybrid_search_tool.py`
  - Fallback ุฅูู Keyword Search
  - ุชุญููู ุงูุฃุฑูุงู ุงูุนุฑุจูุฉ: ูงูง โ 77

### 7. ุงูุฃุฏูุงุช ุงูุฃุณุงุณูุฉ

| ุงูุฃุฏุงุฉ | ุงููุธููุฉ | ุงูููู |
|--------|---------|-------|
| `HybridSearchTool` | ุงูุจุญุซ ุงููุฌูู ุงูุฑุฆูุณู | `tools/hybrid_search_tool.py` |
| `VectorSearchTool` | ุงูุจุญุซ ุงูุฏูุงูู | `tools/vector_tools.py` |
| `FlexibleSearchTool` | ุงุณุชุนูุงูุงุช SQL ูุฑูุฉ | `tools/fetch_tools.py` |
| `GetRelatedDocumentTool` | ุงุณุชุฑุฌุงุน ุงูุณูุงู | `tools/fetch_tools.py` |
| `LegalBlackboardTool` | ุฐุงูุฑุฉ ุงูุฌูุณุฉ | `tools/legal_blackboard_tool.py` |

### 8. ุงูุฅุญุตุงุฆูุงุช (2026-02-05)

| ุงููุคุดุฑ | ุงููููุฉ |
|--------|--------|
| **ุนุฏุฏ ุงููุตุงุฏุฑ ุงููุงููููุฉ** | 550 ูุตุฏุฑ |
| **ุนุฏุฏ ุงูุดุฑุงุฆุญ** | 2,889 ุดุฑูุญุฉ |
| **ุนุฏุฏ ุงููุจุงุฏุฆ ุงููุงููููุฉ** | 221 ูุจุฏุฃ |
| **ูุชูุณุท ููุช ุงูุงุณุชุฌุงุจุฉ** | 3-7 ุซูุงูู |
| **ุฏูุฉ ุงูุจุญุซ** | โ๏ธ ุชุญุชุงุฌ ุชุญุณูู |
| **ุงูุฏูู ุงููุฏุนููุฉ** | ูุตุฑุ ุงูุณุนูุฏูุฉุ ุงูุฅูุงุฑุงุช |

---

## ๐ ุงูุชูุตูุงุช ุงูุงุณุชุฑุงุชูุฌูุฉ

### ุงููุตูุฑุฉ ุงููุฏู (Q1 2026)
1. โ **ุชุฏููู RLS Policies** ุนูู `document_chunks`
2. โ **ุฅูุดุงุก Full-Text Search Index** (GIN)
3. โ **ุชุชุจุน ุงูุงุณุชุนูุงูุงุช ุงููุงุดูุฉ** (Zero Results Logging)

### ุงููุชูุณุทุฉ ุงููุฏู (Q2-Q3 2026)
1. ๐ **ุชุฑููุฉ ูููุฐุฌ Embeddings** (`text-embedding-3-large`)
2. ๐ **ุฅุถุงูุฉ BM25 Hybrid Ranking**
3. ๐ **Query Expansion** ุจุงููุฑุงุฏูุงุช ุงููุงููููุฉ

### ุงูุทูููุฉ ุงููุฏู (Q4 2026+)
1. ๐ **Knowledge Graph** ููุนูุงูุงุช ุจูู ุงูููุงุฏ
2. ๐ **Multi-Hop Reasoning** ูุฑุจุท ุนุฏุฉ ููุงุฏ
3. ๐ **Continuous Learning** ูู feedback ุงููุญุงููู

---

## ๐ ุงููุซุงุฆู ุงููุงููุฉ

1. **[ุงูุชูุฑูุฑ ุงูุชูุตููู](LEGAL_PATH_KNOWLEDGE_BASE_REPORT.md)** (50+ ุตูุญุฉ)
2. **[ุงููุฎุทุทุงุช ุงูุชูุถูุญูุฉ](docs/search_system_diagram.md)** (9 ูุฎุทุทุงุช Mermaid)
3. **[ูุฎุทุท ูุงุนุฏุฉ ุงูุจูุงูุงุช](migrations/db.md)** (36 ุฌุฏูู)

---

## ๐๏ธ ุงููููุงุช ุงูุญุฑุฌุฉ ูููุทูุฑูู

```
e:/law/
โโโ agents/tools/hybrid_search_tool.py    # ๐ ุงููุญุฑู ุงูุฑุฆูุณู (1026 ุณุทุฑ)
โโโ agents/graph/nodes/deep_research.py   # ๐ ููุทู ุงูุจุญุซ (389 ุณุทุฑ)
โโโ agents/graph/nodes/judge.py           # โ๏ธ ุงูููุฌูู (ููุฑุฑ ุงููุณุงุฑ)
โโโ agents/graph/state.py                 # ๐พ ุงูุญุงูุฉ ุงูุนุงูุฉ
```

---

## ๐ก ุงูููุงุท ุงูุญุฑุฌุฉ ููููู

1. **ุงูุดุฑุงุฆุญ โ ุงูููุงุฏ ุงููุงููููุฉ:**
   - ุงูุดุฑูุญุฉ (Chunk) ูุฏ ุชุญุชูู ุนูู ุนุฏุฉ ููุงุฏ ุฃู ุฌุฒุก ูู ูุงุฏุฉ
   - `sequence_number` ูู ุงูููุชุงุญ ูููู ุงูุณูุงู

2. **Vector Search ููุณ ูู ุดูุก:**
   - ุงููุธุงู ูุณุชุฎุฏู Hybrid (Vector + Keyword + Entities)
   - Fallback ุฅูู Keyword Search ุฅุฐุง ูุดู Vector

3. **ุงูุงุณุชุนูุงูุงุช ุงูุจุณูุทุฉ ุชุชุฌุงูุฒ Council:**
   - ุฏุงุฆุฑุฉ ูุตูุฑุฉ (Circuit Breaker) ููุฅุฌุงุจุงุช ุงูุณุฑูุนุฉ
   - ูููุน ุงูุญููุงุช ุงููุงููุงุฆูุฉ

4. **ุงูุณูุงู ุถุฑูุฑู:**
   - ุงุณุชุฑุฌุงุน ยฑ2 chunks ูููู ุงูุงุณุชุซูุงุกุงุช ูุงูุดุฑูุท
   - ุงููุงุฏุฉ 77 ุจููุฑุฏูุง ูุฏ ูุง ุชููู ูุงููุฉ

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2026-02-05 20:49 UTC+3  
**ุงููุณุคูู:** ูุฑูู ุชุทููุฑ Marid AI Legal System
